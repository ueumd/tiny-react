{"version":3,"file":"example.js","sources":["../src/createElement.js","../src/updateNodeElement.js","../src/createDOMElement.js","../src/mountNativeElement.js","../src/mountElement.js","../src/diff.js","../src/render.js","../src/index.js","../example/index.js"],"sourcesContent":["/**\n * 创建 Virtual DOM\n * @param {string} type 类型\n * @param {object | null} props 属性\n * @param  {createElement[]} children 子元素\n * @return {object} Virtual DOM\n * {\n *   type: \"div\",\n *   props: null,\n *   children: [{type: \"text\", props: {textContent: \"Hello\"}}]\n * }\n */\nexport function createElement1(type, props, ...children) {\n\t// 拷贝children 到新数组里\n\t// child 子节点\n\tconst childElements = [].concat(...children).map(child => {\n\t\tif (child instanceof Object) {\n\t\t\treturn child\n\t\t} else {\n\t\t\t// 文本节点 变成对象形式\n\t\t\t/**\n       children: []\n       props: {textContent: '你好 Tiny React'}\n       type: \"text\"\n       */\n\t\t\treturn createElement1('text', { textContent: child })\n\t\t}\n\t})\n\treturn {\n\t\ttype,\n\t\tprops,\n\t\tchildren: childElements\n\t}\n}\n\nexport default function createElement(type, props, ...children) {\n\t// 拷贝children 到新数组里\n\t// child 子节点\n\tconst childElements = [].concat(...children).reduce((result, child) => {\n\n    // 解决 子元素类型 刨除 null true false  \t{2 === 1 && <div>如果2和1相等渲染当前内容</div>}\n\t\tif (child !== false && child !== true && child !== null) {\n\t\t\tif (child instanceof Object) {\n\t\t\t\tresult.push(child)\n\t\t\t} else {\n\t\t\t\t// 文本节点 变成对象形式\n\t\t\t\t/**\n         children: []\n         props: {textContent: '你好 Tiny React'}\n         type: \"text\"\n         */\n\t\t\t\tresult.push(createElement('text', { textContent: child }))\n\t\t\t}\n\t\t}\n\t\t// 将需要保留的 Virtual DOM 放入 result 数组\n\t\treturn result\n\t}, [])\n\n\treturn {\n\t\ttype,\n\t\tprops: Object.assign({ children: childElements }, props), // 通过props.children 拿到子节点\n\t\tchildren: childElements\n\t}\n}\n","/**\n * 为元素添加属性\n * @param newElement 创建好的 DOM元素对象 div\n * @param virtualDOM\n */\nexport default function updateNodeElement(newElement, virtualDOM) {\n\t/**\n   class\n   props: {\n    children: (9) [{…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}]\n    className: \"container\"\n   }\n\n   // event\n   props: {\n     children: [{…}]\n     onClick: ƒ onClick()\n   }\n   */\n\n\t// 获取节点对应属性对象\n\tconst newProps = virtualDOM.props\n\n\tObject.keys(newProps).forEach(propName => {\n\t\tconst newPropsValue = newProps[propName]\n\n\t\t// 是否是事件属性 onClick -> click\n\t\tif (propName.slice(0, 2) === 'on') {\n\t\t\tconst eventName = propName.toLowerCase().slice(2)\n\n\t\t\t// 元素添加事件\n\t\t\t// \t<button onClick={() => alert('你好')}>点击我</button>\n\t\t\tnewElement.addEventListener(eventName, newPropsValue)\n\t\t} else if (propName === 'value' || propName === 'checked') {\n\t\t\tnewElement[propName] = newPropsValue\n\t\t} else if (propName !== 'children') {\n\t\t\t// 属性 className: \"container\"\n\t\t\tif (propName === 'className') {\n\t\t\t\tnewElement.setAttribute('class', newPropsValue)\n\t\t\t} else {\n\t\t\t\t// 普通属性\n\t\t\t\tnewElement.setAttribute(propName, newPropsValue)\n\t\t\t}\n\t\t}\n\t})\n}\n","import mountElement from './mountElement'\nimport updateNodeElement from './updateNodeElement'\n\nexport default function createDOMElement(virtualDOM) {\n\tlet newElement = null\n\n\tif (virtualDOM.type === 'text') {\n\t\t// 文本节点\n\t\tnewElement = document.createTextNode(virtualDOM.props.textContent)\n\t} else {\n\t\t// 元素节点\n\t\tnewElement = document.createElement(virtualDOM.type)\n\t\t// console.log(newElement)\n\n\t\t// 元素结点属性\n\t\tupdateNodeElement(newElement, virtualDOM)\n\t}\n\n\t// 递归创建子节点\n\tvirtualDOM.children.forEach(child => {\n\t\tmountElement(child, newElement)\n\t})\n\n\treturn newElement\n}\n","import createDOMElement from './createDOMElement'\n\nexport default function mountNativeElement(virtualDOM, container) {\n\tconst newElement = createDOMElement(virtualDOM)\n\n\t//将转换的DOM渲染至页面\n\tcontainer.appendChild(newElement)\n}\n\n// export default function mountNativeElement(virtualDOM, container) {\n//   let newElement = null\n//\n//   if (virtualDOM.type === 'text') {\n//     // 文本节点\n//     newElement = document.createTextNode(virtualDOM.props.textContent)\n//   } else {\n//     // 元素节点\n//     newElement = document.createElement(virtualDOM.type)\n//   }\n//\n//   // 递归创建子节点\n//   virtualDOM.children.forEach((child) => {\n//     mountElement(child, newElement)\n//   })\n//\n//   //将转换的DOM渲染至页面\n//   container.appendChild(newElement)\n// }\n","/**\n * 在进行 virtual DOM 转换之前还需要确定 Virtual DOM 的类 Component VS Native Element。\n * @param virtualDOM\n * @param container\n */\nimport mountNativeElement from './mountNativeElement'\n\n/**\n * mountElement\n * @param virtualDOM\n * @param container\n */\nexport default function mountElement(virtualDOM, container) {\n\t// Component VS NativeElement\n\t// 通过 mountNativeElement 方法转换 Native Element\n\tmountNativeElement(virtualDOM, container)\n}\n","import mountElement from './mountElement'\n\nexport default function diff(virtualDOM, container, oldDOM) {\n\t// 判断 oldDOM 是否存在\n\tif (!oldDOM) {\n\t\t// 如果不存在不需要对比 直接接 Virtual DOM 转换为真实DOM\n\t\tmountElement(virtualDOM, container)\n\t}\n}\n","import diff from './diff'\n\nexport default function render(virtualDOM, container, oldDOM) {\n\tdiff(virtualDOM, container, oldDOM)\n}\n","import createElement from './createElement'\nimport render from './render'\nexport default {\n\tcreateElement,\n\trender\n}\n\n/**\n * render -> diff -> mountElement -> mountNativeElement\n */\n","import TinyReact from '../src/index'\n// import TinyReact from \"../dist/tiny-react\"\nconst virtualDOM = (\n\t<div className=\"container\">\n\t\t<h1>你好 Tiny React</h1>\n\t\t<h2>(编码必杀技)</h2>\n\t\t<div>\n\t\t\t嵌套1 <div>嵌套 1.1</div>\n\t\t</div>\n\t\t<h3>(观察: 这个将会被改变)</h3>\n\t\t{2 === 1 && <div>如果2和1相等渲染当前内容</div>}\n\t\t{2 === 2 && <div>2</div>}\n\t\t<span>这是一段内容</span>\n\t\t<button onClick={() => alert('你好')}>点击我</button>\n\t\t<h3>这个将会被删除</h3>\n\t\t2, 3\n\t</div>\n)\n\nconst app = document.querySelector('#app')\nTinyReact.render(virtualDOM, app)\n\nconsole.log(virtualDOM)\n"],"names":["createElement","type","props","children","childElements","concat","reduce","result","child","Object","push","textContent","assign","updateNodeElement","newElement","virtualDOM","newProps","keys","forEach","propName","newPropsValue","slice","eventName","toLowerCase","addEventListener","setAttribute","createDOMElement","document","createTextNode","mountElement","mountNativeElement","container","appendChild","diff","oldDOM","render","alert","app","querySelector","TinyReact","console","log"],"mappings":"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"}